<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Linux - 分类 - 迷途小狼崽</title>
    <link>http://localhost:1313/categories/linux/</link>
    <description>迷途小狼崽的升级打怪之路</description>
    <generator>Hugo 0.139.2 &amp; FixIt v0.3.16-fda3fa66</generator>
    <language>zh-cn</language>
    <lastBuildDate>Fri, 06 Dec 2024 10:19:19 +0800</lastBuildDate>
    <atom:link href="http://localhost:1313/categories/linux/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>记录一些日常遇到的问题和解决方法</title>
      <link>http://localhost:1313/posts/linux/inbox/</link>
      <pubDate>Fri, 06 Dec 2024 10:19:19 +0800</pubDate>
      <guid>http://localhost:1313/posts/linux/inbox/</guid>
      <category domain="http://localhost:1313/categories/linux/">Linux</category>
      <description>&lt;p&gt;问题： &lt;code&gt;tail: inotify cannot be used, reverting to polling: Too many open files&lt;/code&gt; ?&lt;/p&gt;&#xA;&lt;p&gt;解决：在 Linux 系统中，&lt;code&gt;tail&lt;/code&gt;可以使用&lt;code&gt;inotify&lt;/code&gt;机制来高效地监控文件的变化。&lt;code&gt;inotify&lt;/code&gt;不能被使用的时候，会退回到轮询（polling）模式来检测文件变化。&#xA;当打开文件数超过系统限制时，就无法在分配更多的资源给&lt;code&gt;inotify&lt;/code&gt;来跟踪文件的变化。&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;找出打开过多文件的进程, &lt;code&gt;lsof&lt;/code&gt; 命令:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# lsof +c 0 | awk &amp;#39;{print $2}&amp;#39; | sort | uniq -c | sort -nr | head&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;16832&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;8921&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;12481&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;3046&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;m&#34;&gt;5880&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;10266&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 输出结果中，第一列是进程号，第二列是进程名。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;如果是自己的程序，检查代码逻辑； 如果是系统或第三方进程，尝试重启来释放占用的资源（谨慎！！！）；&#xA;2. 调整系统文件描述符限制， &lt;code&gt;ulimit&lt;/code&gt; 命令查看:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;&#xA;&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3&#xA;&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4&#xA;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&#xA;&lt;td class=&#34;lntd&#34;&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# ulimit -n  # 查看软限制&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;65535&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;root@localhost ~&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# ulimit -Hn   # 查看硬限制&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;65535&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#xA;&lt;/div&gt;&#xA;&lt;/div&gt;&lt;ul&gt;&#xA;&lt;li&gt;硬限制是系统管理员设置的上限，软限制不能超过硬限制;&lt;/li&gt;&#xA;&lt;li&gt;在当前会话终端中，执行 &lt;code&gt;ulimint -n [NUMBER]&lt;/code&gt; 命令，修改这个限制，但只对当前会话有效；&lt;/li&gt;&#xA;&lt;li&gt;如果需要永久调整限制，通过编辑 &lt;code&gt;/etc/security/limits.conf&lt;/code&gt;文件，修改完成后重新登录系统就会生效；&lt;/li&gt;&#xA;&lt;/ul&gt;</description>
    </item>
  </channel>
</rss>
